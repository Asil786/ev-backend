{
  "openapi": "3.0.0",
  "info": {
    "title": "EVJoints Admin API",
    "version": "1.1.0",
    "description": "API documentation for EVJoints Admin Dashboard backend"
  },
  "components": {
    "schemas": {
      "Customer": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "example": "John"
          },
          "lastName": {
            "type": "string",
            "example": "Doe"
          },
          "email": {
            "type": "string",
            "format": "email",
            "nullable": true,
            "example": "john.doe@example.com"
          },
          "phone": {
            "type": "string",
            "example": "9876543210"
          },
          "customerRegDate": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "vehicleRegDate": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": "2024-01-20T14:00:00.000Z"
          },
          "registrationNumber": {
            "type": "string",
            "nullable": true,
            "example": "MH12AB1234"
          },
          "subscription": {
            "type": "string",
            "example": "Premium"
          },
          "vehicleType": {
            "type": "string",
            "nullable": true,
            "example": "Car"
          },
          "manufacturer": {
            "type": "string",
            "nullable": true,
            "example": "Tata"
          },
          "vehicleModel": {
            "type": "string",
            "nullable": true,
            "example": "Nexon EV"
          },
          "vehicleVariant": {
            "type": "string",
            "nullable": true,
            "example": "Max"
          },
          "deviceBrand": {
            "type": "string",
            "nullable": true,
            "example": "Samsung"
          },
          "deviceModel": {
            "type": "string",
            "nullable": true,
            "example": "Galaxy S21"
          },
          "devicePlatform": {
            "type": "string",
            "nullable": true,
            "example": "Android"
          },
          "appVersion": {
            "type": "string",
            "nullable": true,
            "example": "2.1.0"
          },
          "navigation": {
            "type": "string",
            "enum": [
              "Yes",
              "No"
            ],
            "example": "Yes"
          },
          "trip": {
            "type": "string",
            "enum": [
              "Yes",
              "No"
            ],
            "example": "Yes"
          },
          "checkIn": {
            "type": "string",
            "enum": [
              "Yes",
              "No"
            ],
            "example": "Yes"
          },
          "vehicles": {
            "type": "array",
            "description": "Array of all vehicles owned by this customer",
            "items": {
              "$ref": "#/components/schemas/Vehicle"
            }
          }
        }
      },
      "Vehicle": {
        "type": "object",
        "properties": {
          "vehicleRegDate": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-20T14:00:00.000Z"
          },
          "registrationNumber": {
            "type": "string",
            "nullable": true,
            "example": "MH12AB1234"
          },
          "vehicleType": {
            "type": "string",
            "nullable": true,
            "example": "Car"
          },
          "manufacturer": {
            "type": "string",
            "nullable": true,
            "example": "Tata"
          },
          "vehicleModel": {
            "type": "string",
            "nullable": true,
            "example": "Nexon EV"
          },
          "vehicleVariant": {
            "type": "string",
            "nullable": true,
            "example": "Max"
          }
        }
      },
      "Pagination": {
        "type": "object",
        "properties": {
          "total": {
            "type": "integer",
            "example": 150,
            "description": "Total number of records"
          },
          "page": {
            "type": "integer",
            "example": 1,
            "description": "Current page number"
          },
          "limit": {
            "type": "integer",
            "example": 10,
            "description": "Number of records per page"
          }
        }
      },
      "CustomersResponse": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Customer"
            }
          },
          "pagination": {
            "$ref": "#/components/schemas/Pagination"
          }
        }
      },
      "Trip": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "dateTime": {
            "type": "string",
            "format": "date-time"
          },
          "firstName": {
            "type": "string"
          },
          "lastName": {
            "type": "string"
          },
          "email": {
            "type": "string",
            "nullable": true
          },
          "mobileNumber": {
            "type": "string"
          },
          "source": {
            "type": "string"
          },
          "destination": {
            "type": "string"
          },
          "totalKm": {
            "type": "number"
          },
          "stationConnectorCount": {
            "type": "string"
          },
          "chargingStopsCount": {
            "type": "integer"
          },
          "evModel": {
            "type": "string"
          },
          "evVariant": {
            "type": "string"
          },
          "feedback": {
            "type": "string",
            "nullable": true
          },
          "tripStatus": {
            "type": "string"
          },
          "tripCompletionStatus": {
            "type": "string"
          },
          "hasTripStory": {
            "type": "string"
          },
          "storyStatus": {
            "type": "string",
            "nullable": true
          },
          "blogLink": {
            "type": "string",
            "nullable": true
          },
          "approvedBy": {
            "type": "string"
          }
        }
      },
      "TripsResponse": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Trip"
            }
          },
          "pagination": {
            "type": "object",
            "properties": {
              "total": {
                "type": "integer"
              },
              "page": {
                "type": "integer"
              },
              "limit": {
                "type": "integer"
              }
            }
          }
        }
      },
      "Error": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Database connection error"
          }
        }
      }
    }
  },
  "paths": {
    "/api/customers": {
      "get": {
        "summary": "Get paginated list of customers",
        "description": "Retrieves a paginated list of customers with their vehicle information, device details, and subscription status. Supports server-side sorting.",
        "tags": [
          "Customers"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            },
            "description": "Page number for pagination"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 10
            },
            "description": "Number of records per page"
          },
          {
            "in": "query",
            "name": "sortBy",
            "schema": {
              "type": "string",
              "enum": [
                "id",
                "firstName",
                "lastName",
                "email",
                "phone",
                "customerRegDate",
                "vehicleRegDate",
                "registrationNumber",
                "vehicleType",
                "manufacturer",
                "vehicleModel",
                "subscription"
              ],
              "default": "customerRegDate"
            },
            "description": "Field to sort by"
          },
          {
            "in": "query",
            "name": "order",
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "default": "desc"
            },
            "description": "Sort order (ascending or descending)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with customer data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomersResponse"
                },
                "example": {
                  "data": [
                    {
                      "firstName": "John",
                      "lastName": "Doe",
                      "email": "john.doe@example.com",
                      "phone": "9876543210",
                      "customerRegDate": "2024-01-15T10:30:00.000Z",
                      "vehicleRegDate": "2024-01-20T14:00:00.000Z",
                      "registrationNumber": "MH12AB1234",
                      "subscription": "Premium",
                      "vehicleType": "Car",
                      "manufacturer": "Tata",
                      "vehicleModel": "Nexon EV",
                      "vehicleVariant": "Max",
                      "deviceBrand": "Samsung",
                      "deviceModel": "Galaxy S21",
                      "devicePlatform": "Android",
                      "appVersion": "2.1.0",
                      "navigation": "Yes",
                      "trip": "Yes",
                      "checkIn": "Yes",
                      "vehicles": []
                    }
                  ],
                  "pagination": {
                    "total": 150,
                    "page": 1,
                    "limit": 10
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/trips": {
      "get": {
        "summary": "Get paginated list of trip check-ins",
        "description": "Retrieves trip records with filtering by status and story presence.",
        "tags": [
          "Trips"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer",
              "default": 1
            },
            "description": "Page number"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 10
            },
            "description": "Items per page"
          },
          {
            "in": "query",
            "name": "status",
            "schema": {
              "type": "string",
              "default": "All"
            },
            "description": "Filter by trip status"
          },
          {
            "in": "query",
            "name": "story",
            "schema": {
              "type": "string",
              "default": "All"
            },
            "description": "Filter by story presence"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TripsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/trips/story/{id}/": {
      "put": {
        "summary": "Update trip story status",
        "tags": [
          "Trips"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "enum": [
                      "Approved",
                      "Rejected"
                    ]
                  },
                  "name": {
                    "type": "string"
                  },
                  "blogLink": {
                    "type": "string"
                  }
                },
                "required": [
                  "action",
                  "name"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "tags": []
}